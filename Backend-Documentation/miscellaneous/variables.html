<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Procurement App Backend Documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">Procurement App Backend Documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content miscellaneous-variables">
                   <div class="content-data">

















<ol class="breadcrumb">
  <li>Miscellaneous</li>
  <li>Variables</li>
</ol>

<section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <ul class="index-list">
                        <li>
                            <a href="#auth" title="src/middleware/auth.ts" ><b>auth</b>&nbsp;&nbsp;&nbsp;(src/.../auth.ts)</a>
                        </li>
                        <li>
                            <a href="#config" title="src/config.ts" ><b>config</b>&nbsp;&nbsp;&nbsp;(src/.../config.ts)</a>
                        </li>
                        <li>
                            <a href="#JWT_SECRET" title="src/config.ts" ><b>JWT_SECRET</b>&nbsp;&nbsp;&nbsp;(src/.../config.ts)</a>
                        </li>
                        <li>
                            <a href="#mongo" title="src/db/mongoose.ts" ><b>mongo</b>&nbsp;&nbsp;&nbsp;(src/.../mongoose.ts)</a>
                        </li>
                        <li>
                            <a href="#MONGODB_URI" title="src/config.ts" ><b>MONGODB_URI</b>&nbsp;&nbsp;&nbsp;(src/.../config.ts)</a>
                        </li>
                        <li>
                            <a href="#Product" title="src/models/productModel.ts" ><b>Product</b>&nbsp;&nbsp;&nbsp;(src/.../productModel.ts)</a>
                        </li>
                        <li>
                            <a href="#productSchema" title="src/models/productModel.ts" ><b>productSchema</b>&nbsp;&nbsp;&nbsp;(src/.../productModel.ts)</a>
                        </li>
                        <li>
                            <a href="#server" title="src/server.ts" ><b>server</b>&nbsp;&nbsp;&nbsp;(src/.../server.ts)</a>
                        </li>
                        <li>
                            <a href="#SERVER" title="src/config.ts" ><b>SERVER</b>&nbsp;&nbsp;&nbsp;(src/.../config.ts)</a>
                        </li>
                        <li>
                            <a href="#SERVER_HOSTNAME" title="src/config.ts" ><b>SERVER_HOSTNAME</b>&nbsp;&nbsp;&nbsp;(src/.../config.ts)</a>
                        </li>
                        <li>
                            <a href="#SERVER_PORT" title="src/config.ts" ><b>SERVER_PORT</b>&nbsp;&nbsp;&nbsp;(src/.../config.ts)</a>
                        </li>
                        <li>
                            <a href="#User" title="src/models/userModel.ts" ><b>User</b>&nbsp;&nbsp;&nbsp;(src/.../userModel.ts)</a>
                        </li>
                        <li>
                            <a href="#userSchema" title="src/models/userModel.ts" ><b>userSchema</b>&nbsp;&nbsp;&nbsp;(src/.../userModel.ts)</a>
                        </li>
                    </ul>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    <h3>src/middleware/auth.ts</h3>
    <section>
    <h3></h3>    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="auth"></a>
                    <span class="name">
                        <span ><b>auth</b></span>
                        <a href="#auth"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>async (req: Request, res: Response, next: NextFunction) &#x3D;&gt; {
    try {
        const header &#x3D; req.header(&#x27;Authorization&#x27;)
        console.log(header)
        if (!header) {
            throw new Error()
        }
        const token &#x3D; header.replace(&#x27;Bearer &#x27;, &#x27;&#x27;);
        // console.log(token)
        const decoded &#x3D; jwt.verify(token, config.server.jwt_secret) as JwtPayload
        // console.log(decoded)
        const user &#x3D; await User.findOne({
            _id: decoded._id,
            &#x27;tokens.token&#x27;: token
        })
        if (!user) {
            throw new Error()
        }
        req.token &#x3D; token;
        req.user &#x3D; user;
        next()
    } catch (error) {
        res.status(401).send({
            error: &#x27;Please authenticate.&#x27;
        })
    }
}</code>
                    </td>
                </tr>


        </tbody>
    </table>
</section>
    <h3>src/config.ts</h3>
    <section>
    <h3></h3>    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="config"></a>
                    <span class="name">
                        <span ><b>config</b></span>
                        <a href="#config"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>{
    server: SERVER
}</code>
                    </td>
                </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="JWT_SECRET"></a>
                    <span class="name">
                        <span ><b>JWT_SECRET</b></span>
                        <a href="#JWT_SECRET"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>process.env.JWT_SECRET || &quot;thisismysecret&quot;</code>
                    </td>
                </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="MONGODB_URI"></a>
                    <span class="name">
                        <span ><b>MONGODB_URI</b></span>
                        <a href="#MONGODB_URI"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>process.env.MONGODB_URL || &#x27;mongodb://127.0.0.1:27017&#x27;</code>
                    </td>
                </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="SERVER"></a>
                    <span class="name">
                        <span ><b>SERVER</b></span>
                        <a href="#SERVER"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>{
    hostname: SERVER_HOSTNAME,
    port: SERVER_PORT,
    mongodb_uri: MONGODB_URI,
    jwt_secret: JWT_SECRET
}</code>
                    </td>
                </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="SERVER_HOSTNAME"></a>
                    <span class="name">
                        <span ><b>SERVER_HOSTNAME</b></span>
                        <a href="#SERVER_HOSTNAME"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>process.env.SERVER_HOSTNAME || &#x27;localhost&#x27;</code>
                    </td>
                </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="SERVER_PORT"></a>
                    <span class="name">
                        <span ><b>SERVER_PORT</b></span>
                        <a href="#SERVER_PORT"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>process.env.SERVER_PORT || 3000</code>
                    </td>
                </tr>


        </tbody>
    </table>
</section>
    <h3>src/db/mongoose.ts</h3>
    <section>
    <h3></h3>    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="mongo"></a>
                    <span class="name">
                        <span ><b>mongo</b></span>
                        <a href="#mongo"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>() &#x3D;&gt; {
    if (!config.server.mongodb_uri) {
        console.log(&quot;No mongo connection string. Set MONGODB_URI environment variable.&quot;);
        process.exit(1);
    }
    const connection &#x3D; mongoose.connection;
    connection.on(&quot;connected&quot;, () &#x3D;&gt; {
        console.log(&quot;Mongo Connection Established&quot;);
    });
    connection.on(&quot;reconnected&quot;, () &#x3D;&gt; {
        console.log(&quot;Mongo Connection Reestablished&quot;);
    });
    connection.on(&quot;disconnected&quot;, () &#x3D;&gt; {
        console.log(&quot;Mongo Connection Disconnected&quot;);
        console.log(&quot;Trying to reconnect to Mongo ...&quot;);
        setTimeout(() &#x3D;&gt; {
            mongoose.connect(config.server.mongodb_uri, {
                autoReconnect: false,
                keepAlive: true,
                useNewUrlParser: true,
                useCreateIndex: true,
                useUnifiedTopology: true,
                socketTimeoutMS: 3000, 
                connectTimeoutMS: 3000
            });
        }, 3000);
    });
    connection.on(&quot;close&quot;, () &#x3D;&gt; {
        console.log(&quot;Mongo Connection Closed&quot;);
    });
    connection.on(&quot;error&quot;, (error: Error) &#x3D;&gt; {
        console.log(&quot;Mongo Connection ERROR: &quot; + error);
    });

    const run &#x3D; async () &#x3D;&gt; {
        try {
            await mongoose.connect(config.server.mongodb_uri, {
                autoReconnect: false,
                keepAlive: true,
                useNewUrlParser: true,
                useUnifiedTopology: true,
                useCreateIndex: true
            });
        } catch (error) {
            console.error(error)
        }
    };
    run();
}</code>
                    </td>
                </tr>


        </tbody>
    </table>
</section>
    <h3>src/models/productModel.ts</h3>
    <section>
    <h3></h3>    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="Product"></a>
                    <span class="name">
                        <span ><b>Product</b></span>
                        <a href="#Product"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../interfaces/IProduct.html" target="_self" >Model&lt;IProduct&gt;</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>model(&quot;Product&quot;, productSchema)</code>
                    </td>
                </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="productSchema"></a>
                    <span class="name">
                        <span ><b>productSchema</b></span>
                        <a href="#productSchema"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>Schema</code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new Schema({
    productname: {
        type: String,
        unique: false,
        required: true,
        trim: true
    },
    price: {
        type: Number,
        unique: false,
        required: true,
    },
    description: {
        type: String,
        required: true,
        trim: true
    },
    image: {
        type: Buffer
    },
    creator: {
        type: Schema.Types.ObjectId,
        required: true,
        ref: &#x27;User&#x27;
    },
    customer: {
        type: Schema.Types.ObjectId,
        ref: &#x27;User&#x27;
    }
}, {
    timestamps: true
})</code>
                    </td>
                </tr>


        </tbody>
    </table>
</section>
    <h3>src/server.ts</h3>
    <section>
    <h3></h3>    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="server"></a>
                    <span class="name">
                        <span ><b>server</b></span>
                        <a href="#server"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new Server()</code>
                    </td>
                </tr>


        </tbody>
    </table>
</section>
    <h3>src/models/userModel.ts</h3>
    <section>
    <h3></h3>    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="User"></a>
                    <span class="name">
                        <span ><b>User</b></span>
                        <a href="#User"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../interfaces/IModelUser.html" target="_self" >IModelUser</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>model&lt;IUser, IModelUser&gt;(&quot;User&quot;, userSchema)</code>
                    </td>
                </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="userSchema"></a>
                    <span class="name">
                        <span ><b>userSchema</b></span>
                        <a href="#userSchema"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>Schema</code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>new Schema({
    username: {
        type: String,
        unique: false,
        required: true,
        trim: true
    },
    postcode: {
        type: Number,
        unique: false,
        required: false,
    },
    city: {
        type: String,
        unique: false,
        required: false,
        trim: true
    },
    street: {
        type: String,
        unique: false,
        required: false,
        trim: true
    },
    role: {
        type: String,
        enum: [&#x27;Admin&#x27;, &#x27;Staff&#x27;, &#x27;Customer&#x27;],
        unique: false,
        required: true,
    },
    email: {
        type: String,
        unique: true,
        required: true,
        trim: true
    },
    password: {
        type: String,
        required: true,
    },
    tokens: [{
        token: {
            type: String,
            required: true
        }
    }],
}, {
    timestamps: true
})</code>
                    </td>
                </tr>


        </tbody>
    </table>
</section>



                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'miscellaneous-variables';
            var COMPODOC_CURRENT_PAGE_URL = 'variables.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
